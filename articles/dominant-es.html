<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mapping Dominant Ecological Sites using SSURGO Data • soilDB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mapping Dominant Ecological Sites using SSURGO Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">soilDB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.8.14</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/dominant-es.html">Mapping Dominant Ecological Sites using SSURGO Data</a></li>
    <li><a class="dropdown-item" href="../articles/fetchNASIS.html">fetchNASIS(from='pedons') Columns</a></li>
    <li><a class="dropdown-item" href="../articles/local-ssurgo.html">Local Soil Survey Geographic (SSURGO) Databases</a></li>
    <li><a class="dropdown-item" href="../articles/wcs-ssurgo.html">Map Unit Key Grids and Thematic Maps of Soil Survey Geographic (SSURGO) Data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ncss-tech/soilDB/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mapping Dominant Ecological Sites using SSURGO Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ncss-tech/soilDB/blob/master/vignettes/dominant-es.Rmd" class="external-link"><code>vignettes/dominant-es.Rmd</code></a></small>
      <div class="d-none name"><code>dominant-es.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates how to extract and map dominant ecological
site information for a given Area of Interest (AOI) using the
<code>soilDB</code> package and open-source geospatial tools in R.</p>
<p>For a general introduction to geospatial data in R, see the <a href="https://r-spatial.github.io/sf/" class="external-link"><code>sf</code> package
documentation</a>, <a href="https://rspatial.github.io/terra/" class="external-link"><code>terra</code> package
documentation</a>, the <a href="https://r.geocompx.org/" class="external-link"><em>Geocomputation with R</em> book</a>
and the <a href="https://rspatial.org/" class="external-link"><em>Spatial Data Science with R
and <code>terra</code></em> book</a>.</p>
<p>We will:</p>
<ul>
<li><p>Load SSURGO spatial data</p></li>
<li><p>Query Soil Data Access (SDA) for dominant ecological site
assignments</p></li>
<li><p>Join tabular and spatial data</p></li>
<li><p>Export and visualize the results</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>In this vignette we will use <code>sf</code> functions and object
types for processing and storing spatial data. This package is used
under the hood by <code>soilDB</code> for processing SSURGO data. The
<code>terra</code> package can be used with only minor changes in
syntax.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ncss-tech/soilDB/" class="external-link">soilDB</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-ssurgo-spatial-data">Load SSURGO Spatial Data<a class="anchor" aria-label="anchor" href="#load-ssurgo-spatial-data"></a>
</h2>
<div class="section level3">
<h3 id="using-soil-data-access">Using Soil Data Access<a class="anchor" aria-label="anchor" href="#using-soil-data-access"></a>
</h3>
<p>You can use <code><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery()</a></code> and
<code><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial()</a></code> to retrieve spatial data directly from
Soil Data Access (SDA), bypassing the need for local files.</p>
<div class="section level4">
<h4 id="option-1-use-sda_spatialquery-to-get-mukey-polygons-for-an-aoi">Option 1: Use <code>SDA_spatialQuery()</code> to get mukey polygons
for an AOI<a class="anchor" aria-label="anchor" href="#option-1-use-sda_spatialquery-to-get-mukey-polygons-for-an-aoi"></a>
</h4>
<p>Define Area of Interest (AOI) as a bounding box <code>sf</code>
POLYGON.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sfc.html" class="external-link">st_as_sfc</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  xmin <span class="op">=</span> <span class="op">-</span><span class="fl">120.85</span>,</span>
<span>  xmax <span class="op">=</span> <span class="op">-</span><span class="fl">120.775</span>,</span>
<span>  ymin <span class="op">=</span> <span class="fl">37.975</span>,</span>
<span>  ymax <span class="op">=</span> <span class="fl">38.0</span></span>
<span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Query SDA for map unit polygons cropped to the AOI</span></span>
<span><span class="va">soil_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">aoi</span>, </span>
<span>  what <span class="op">=</span> <span class="st">"mupolygon"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">soil_polygons</span><span class="op">[</span><span class="st">"mukey"</span><span class="op">]</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"SSURGO Map Units from SDA_spatialQuery"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/SDA-spatialQuery-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soil_polygons</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 2 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -120.8235 ymin: 37.98283 xmax: -120.7807 ymax: 38.01469</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##     mukey    area_ac                           geom</span></span>
<span><span class="co">## 1 2441798 187.863380 POLYGON ((-120.7961 38.0051...</span></span>
<span><span class="co">## 2 2924886   6.788244 POLYGON ((-120.8201 37.9839...</span></span>
<span><span class="co">## 3 2450844  30.732837 POLYGON ((-120.7897 37.9864...</span></span>
<span><span class="co">## 4 2924752  11.813110 POLYGON ((-120.7836 37.9887...</span></span>
<span><span class="co">## 5 2441798  32.166563 POLYGON ((-120.7884 37.9883...</span></span>
<span><span class="co">## 6 2450844  48.484422 POLYGON ((-120.7985 37.9945...</span></span></code></pre>
<p>You can also set <code>geomIntersection = TRUE</code> so that
intersecting geometries are cropped to the AOI. This is convenient if
you have a very specific AOI in mind or would like to reduce the amount
of data you are going to download.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Query SDA for map unit polygons cropped to the AOI</span></span>
<span><span class="va">soil_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">aoi</span>, </span>
<span>  what <span class="op">=</span> <span class="st">"mupolygon"</span>, </span>
<span>  geomIntersection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">soil_polygons</span><span class="op">[</span><span class="st">"mukey"</span><span class="op">]</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Cropped SSURGO Map Units from SDA_spatialQuery"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/SDA-spatialQuery-geomIntersect-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soil_polygons</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 2 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -120.8235 ymin: 37.98283 xmax: -120.7807 ymax: 38</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##     mukey   area_ac                           geom</span></span>
<span><span class="co">## 1 2441798 26.735794 POLYGON ((-120.7922 37.998,...</span></span>
<span><span class="co">## 2 2924886  6.788244 POLYGON ((-120.82 37.98283,...</span></span>
<span><span class="co">## 3 2450844 30.732837 POLYGON ((-120.79 37.98505,...</span></span>
<span><span class="co">## 4 2924752 11.813110 POLYGON ((-120.7836 37.9887...</span></span>
<span><span class="co">## 5 2441798 32.166563 POLYGON ((-120.786 37.98831...</span></span>
<span><span class="co">## 6 2450844 48.484422 POLYGON ((-120.8046 37.9885...</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="option-2-use-fetchsda_spatial">Option 2: Use <code>fetchSDA_spatial()</code><a class="anchor" aria-label="anchor" href="#option-2-use-fetchsda_spatial"></a>
</h4>
<p>Next, we use <code><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial()</a></code>.</p>
<p>This function is different because instead of using an area of
interest, it takes a vector of map unit or legend identifiers.</p>
<p>Here, we take the unique map unit keys from the <strong>Option
1</strong> result and return the <em>full</em> extent of those map units
(not just the intersecting polygons). This is particularly helpful when
doing studies that involve the full extent of map unit concepts, as
opposed to more site-specific analyses.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_ssurgo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">soil_polygons</span><span class="op">$</span><span class="va">mukey</span><span class="op">)</span>, </span>
<span>  by.col <span class="op">=</span> <span class="st">"mukey"</span>,</span>
<span>  add.fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"legend.areaname"</span>, </span>
<span>                 <span class="st">"mapunit.muname"</span>, </span>
<span>                 <span class="st">"mapunit.farmlndcl"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mu_ssurgo</span><span class="op">[</span><span class="st">"mukey"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"SSURGO Map Units from fetchSDA_spatial"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/fetch-SDA-spatial-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mu_ssurgo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 6 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -120.8318 ymin: 37.87806 xmax: -120.6511 ymax: 38.09373</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##     mukey areasymbol nationalmusym</span></span>
<span><span class="co">## 1 2441798      CA630         2mywp</span></span>
<span><span class="co">## 2 2441798      CA630         2mywp</span></span>
<span><span class="co">## 3 2441798      CA630         2mywp</span></span>
<span><span class="co">## 4 2441798      CA630         2mywp</span></span>
<span><span class="co">## 5 2441798      CA630         2mywp</span></span>
<span><span class="co">## 6 2441798      CA630         2mywp</span></span>
<span><span class="co">##                                                                              areaname</span></span>
<span><span class="co">## 1 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">## 2 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">## 3 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">## 4 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">## 5 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">## 6 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">##                                                muname          farmlndcl</span></span>
<span><span class="co">## 1 Bonanza-Loafercreek complex, 3 to 15 percent slopes Not prime farmland</span></span>
<span><span class="co">## 2 Bonanza-Loafercreek complex, 3 to 15 percent slopes Not prime farmland</span></span>
<span><span class="co">## 3 Bonanza-Loafercreek complex, 3 to 15 percent slopes Not prime farmland</span></span>
<span><span class="co">## 4 Bonanza-Loafercreek complex, 3 to 15 percent slopes Not prime farmland</span></span>
<span><span class="co">## 5 Bonanza-Loafercreek complex, 3 to 15 percent slopes Not prime farmland</span></span>
<span><span class="co">## 6 Bonanza-Loafercreek complex, 3 to 15 percent slopes Not prime farmland</span></span>
<span><span class="co">##                             geom</span></span>
<span><span class="co">## 1 POLYGON ((-120.6513 37.9647...</span></span>
<span><span class="co">## 2 POLYGON ((-120.7555 37.9478...</span></span>
<span><span class="co">## 3 POLYGON ((-120.7659 38.0160...</span></span>
<span><span class="co">## 4 POLYGON ((-120.7961 38.0051...</span></span>
<span><span class="co">## 5 POLYGON ((-120.8276 38.0924...</span></span>
<span><span class="co">## 6 POLYGON ((-120.7017 37.8785...</span></span></code></pre>
<p>Note that using <code>add.fields</code> we have included some
additional contextual information: area name, map unit name, and map
unit farmland classification.</p>
<div class="section level5">
<h5 id="fetchsda_spatial-geometry-sources">
<code>fetchSDA_spatial()</code> geometry sources<a class="anchor" aria-label="anchor" href="#fetchsda_spatial-geometry-sources"></a>
</h5>
<p><code><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial()</a></code> <code>geom.src</code> argument can be
used to return SSURGO map unit polygons and survey area polygons,
STATSGO mapunit polygons, and MLRA polygons.</p>
<p>Here is an example using STATSGO. We use
<code><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery()</a></code> to fetch the data for our AOI, then
<code><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial()</a></code> to get the full extent of those map unit
concepts.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">statsgo_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery</a></span><span class="op">(</span></span>
<span>  <span class="va">aoi</span>, </span>
<span>  what <span class="op">=</span> <span class="st">"mupolygon"</span>,</span>
<span>  db <span class="op">=</span> <span class="st">"STATSGO"</span>,</span>
<span>  geomIntersection <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">statsgo_polygons</span><span class="op">[</span><span class="st">"mukey"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"STATSGO Map Units from SDA_spatialQuery"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/fetch-SDA-spatial-statsgo-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">statsgo_polygons</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 3 features and 2 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -120.85 ymin: 37.975 xmax: -120.775 ymax: 38</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##    mukey   area_ac                           geom</span></span>
<span><span class="co">## 1 660921 1668.6742 POLYGON ((-120.7998 37.975,...</span></span>
<span><span class="co">## 2 660960  253.0798 POLYGON ((-120.85 37.975, -...</span></span>
<span><span class="co">## 3 660939 2596.0225 POLYGON ((-120.8427 37.975,...</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_statsgo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">statsgo_polygons</span><span class="op">$</span><span class="va">mukey</span><span class="op">)</span>, </span>
<span>  by.col <span class="op">=</span> <span class="st">"mukey"</span>,</span>
<span>  db <span class="op">=</span> <span class="st">"STATSGO"</span>,</span>
<span>  add.fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"legend.areaname"</span>, <span class="st">"mapunit.muname"</span>, <span class="st">"mapunit.farmlndcl"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mu_statsgo</span><span class="op">[</span><span class="st">"mukey"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"STATSGO Map Units from fetchSDA_spatial"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/fetch-SDA-spatial-statsgo-2.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mu_statsgo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 6 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -121.0731 ymin: 37.07511 xmax: -119.9157 ymax: 38.29961</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##    mukey areasymbol nationalmusym      areaname</span></span>
<span><span class="co">## 1 660921         US          q5r1 United States</span></span>
<span><span class="co">## 2 660939         US          q5rm United States</span></span>
<span><span class="co">## 3 660960         US          q5s9 United States</span></span>
<span><span class="co">## 4 660939         US          q5rm United States</span></span>
<span><span class="co">## 5 660939         US          q5rm United States</span></span>
<span><span class="co">## 6 660939         US          q5rm United States</span></span>
<span><span class="co">##                                 muname farmlndcl                           geom</span></span>
<span><span class="co">## 1 Whiterock-Rock outcrop-Auburn (s818)      &lt;NA&gt; POLYGON ((-120.794 38.18986...</span></span>
<span><span class="co">## 2                  Peters-Pentz (s836)      &lt;NA&gt; POLYGON ((-120.9141 38.0735...</span></span>
<span><span class="co">## 3       Finrod-Cogna-Archerdale (s857)      &lt;NA&gt; POLYGON ((-120.9711 37.9490...</span></span>
<span><span class="co">## 4                  Peters-Pentz (s836)      &lt;NA&gt; POLYGON ((-121.0478 38.2898...</span></span>
<span><span class="co">## 5                  Peters-Pentz (s836)      &lt;NA&gt; POLYGON ((-120.8763 37.8606...</span></span>
<span><span class="co">## 6                  Peters-Pentz (s836)      &lt;NA&gt; POLYGON ((-120.801 37.92773...</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery</a></span><span class="op">(</span><span class="va">aoi</span>, what <span class="op">=</span> <span class="st">"areasymbol"</span><span class="op">)</span></span>
<span><span class="va">ssas</span></span></code></pre></div>
<pre><code><span><span class="co">##   areasymbol</span></span>
<span><span class="co">## 1      CA630</span></span>
<span><span class="co">## 2      CA632</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial</a></span><span class="op">(</span></span>
<span>  <span class="va">ssas</span><span class="op">$</span><span class="va">areasymbol</span>, </span>
<span>  by.col <span class="op">=</span> <span class="st">"areasymbol"</span>,</span>
<span>  geom.src <span class="op">=</span> <span class="st">"sapolygon"</span>,</span>
<span>  add.fields <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"legend.areaname"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssa</span><span class="op">[</span><span class="st">"areasymbol"</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"SSURGO Soil Survey Area from SDA"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/fetch-SDA-spatial-ssa-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ssa</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 2 features and 3 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -120.9955 ymin: 37.63352 xmax: -120.1595 ymax: 38.46714</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">##    lkey areasymbol</span></span>
<span><span class="co">## 1 14103      CA630</span></span>
<span><span class="co">## 2 17969      CA632</span></span>
<span><span class="co">##                                                                              areaname</span></span>
<span><span class="co">## 1 Central Sierra Foothills Area, California, Parts of Calaveras and Tuolumne Counties</span></span>
<span><span class="co">## 2                                        Stanislaus County, California, Northern Part</span></span>
<span><span class="co">##                             geom</span></span>
<span><span class="co">## 1 POLYGON ((-120.3907 38.4630...</span></span>
<span><span class="co">## 2 POLYGON ((-120.6584 37.8202...</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="sda_spatialquery-vs--fetchsda_spatial">
<code>SDA_spatialQuery()</code>
vs. <code>fetchSDA_spatial()</code><a class="anchor" aria-label="anchor" href="#sda_spatialquery-vs--fetchsda_spatial"></a>
</h4>
<ul>
<li><p><code><a href="../reference/SDA_spatialQuery.html">SDA_spatialQuery()</a></code> is ideal for spatial queries
where you have a specific, possibly complex, area of interest.</p></li>
<li><p><code><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial()</a></code> returns the full extent of the
specified map unit concepts, optionally including more legend and map
unit attributes via <code>add.fields</code> argument.</p></li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="local-data-sources">Local Data Sources<a class="anchor" aria-label="anchor" href="#local-data-sources"></a>
</h3>
<p>If working with large extents, it is generally better to be use a
local data source. You can download SSURGO data from Web Soil Survey
using <code><a href="../reference/downloadSSURGO.html">downloadSSURGO()</a></code>. Then, you can create GeoPackage or
other database types using <code><a href="../reference/createSSURGO.html">createSSURGO()</a></code> or the <a href="https://www.nrcs.usda.gov/resources/data-and-reports/ssurgo-portal" class="external-link">SSURGOPortal</a>
tools. This process is described in detail in the <a href="https://ncss-tech.github.io/soilDB/articles/local-ssurgo.html" class="external-link">Local
SSURGO Databases vignette</a>. See also the <a href="https://github.com/brownag/SSURGOPortalR" class="external-link">SSURGOPortal R
package</a>.</p>
<p>Assuming you have a GeoPackage from SSURGOPortal
(<code>"soilmu_a.gpkg"</code>), then you can read it with
<code><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">sf::st_read()</a></code> or <code><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">terra::vect()</a></code></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssurgo_path</span> <span class="op">&lt;-</span> <span class="st">"data/soilmu_a.gpkg"</span>  <span class="co"># Replace with your actual path</span></span>
<span><span class="va">soil_polygons</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">ssurgo_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">soil_polygons</span><span class="op">)</span></span></code></pre></div>
<p>This <code>soil_polygons</code> object should have the standard set
of columns we would expect for a SSURGO map unit data source, including:
map unit key (<code>mukey</code>), area symbol
(<code>areasymbol</code>), map unit symbol (<code>musym</code>).</p>
</div>
</div>
<div class="section level2">
<h2 id="query-sda-for-dominant-ecological-site-info">Query SDA for Dominant Ecological Site Info<a class="anchor" aria-label="anchor" href="#query-sda-for-dominant-ecological-site-info"></a>
</h2>
<div class="section level3">
<h3 id="extract-unique-map-unit-keys">Extract Unique Map Unit Keys<a class="anchor" aria-label="anchor" href="#extract-unique-map-unit-keys"></a>
</h3>
<p>As we did above for <code><a href="../reference/fetchSDA_spatial.html">fetchSDA_spatial()</a></code> we are going to
get the unique set of map units in our AOI.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mukeys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">soil_polygons</span><span class="op">$</span><span class="va">mukey</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-get_sda_coecoclass">Use <code>get_SDA_coecoclass()</code><a class="anchor" aria-label="anchor" href="#use-get_sda_coecoclass"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eco_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_SDA_coecoclass.html">get_SDA_coecoclass</a></span><span class="op">(</span>mukeys <span class="op">=</span> <span class="va">mukeys</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eco_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     mukey areasymbol  lkey                                      muname    cokey</span></span>
<span><span class="co">## 1 1403409      CA632 17969 Archerdale clay loam, 0 to 2 percent slopes 27449761</span></span>
<span><span class="co">## 2 1403409      CA632 17969 Archerdale clay loam, 0 to 2 percent slopes 27449762</span></span>
<span><span class="co">## 3 1403409      CA632 17969 Archerdale clay loam, 0 to 2 percent slopes 27449763</span></span>
<span><span class="co">## 4 1403409      CA632 17969 Archerdale clay loam, 0 to 2 percent slopes 27449764</span></span>
<span><span class="co">## 5 1403409      CA632 17969 Archerdale clay loam, 0 to 2 percent slopes 27449765</span></span>
<span><span class="co">## 6 1403409      CA632 17969 Archerdale clay loam, 0 to 2 percent slopes 27449766</span></span>
<span><span class="co">##   coecoclasskey comppct_r majcompflag   compname localphase compkind</span></span>
<span><span class="co">## 1            NA         4         No       Capay       clay   Series</span></span>
<span><span class="co">## 2            NA         1         No     Chuloak sandy loam   Series</span></span>
<span><span class="co">## 3            NA         2         No  Clear Lake       clay   Series</span></span>
<span><span class="co">## 4            NA         1         No      Finrod       clay   Series</span></span>
<span><span class="co">## 5            NA         3         No  Hicksville       loam   Series</span></span>
<span><span class="co">## 6            NA         3         No  Hollenbeck       clay   Series</span></span>
<span><span class="co">##     ecoclassid ecoclassname ecoclasstypename  ecoclassref</span></span>
<span><span class="co">## 1 Not assigned Not assigned     Not assigned Not assigned</span></span>
<span><span class="co">## 2 Not assigned Not assigned     Not assigned Not assigned</span></span>
<span><span class="co">## 3 Not assigned Not assigned     Not assigned Not assigned</span></span>
<span><span class="co">## 4 Not assigned Not assigned     Not assigned Not assigned</span></span>
<span><span class="co">## 5 Not assigned Not assigned     Not assigned Not assigned</span></span>
<span><span class="co">## 6 Not assigned Not assigned     Not assigned Not assigned</span></span></code></pre>
<p>This function returns a data frame including <code>mukey</code>,
<code>cokey</code>, <code>ecoclassid</code>, and
<code>ecoclassname</code>.</p>
<p>There are several methods for aggregating from component to map unit
level available in <code><a href="../reference/get_SDA_coecoclass.html">get_SDA_coecoclass()</a></code>. The default
aggregation method is <code>"none"</code> which will return 1 record per
map unit <em>component</em>, so many map units will have more than one
record.</p>
</div>
<div class="section level3">
<h3 id="using-methoddominant-component">Using <code>method="dominant component"</code><a class="anchor" aria-label="anchor" href="#using-methoddominant-component"></a>
</h3>
<p>Most often, users want “typical” conditions that can apply to a whole
map unit.</p>
<p>Sometimes it is helpful to be able to point to a <em>specific</em>
component, so that you do not have to reason over mathematical
aggregation of distinct components within map unit concepts. The most
common method to select one component per map unit is
<code>"dominant component"</code></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eco_data_domcond</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_SDA_coecoclass.html">get_SDA_coecoclass</a></span><span class="op">(</span></span>
<span>  mukeys <span class="op">=</span> <span class="va">mukeys</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"dominant component"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eco_data_domcond</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mukey areasymbol  lkey</span></span>
<span><span class="co">## 8  1403409      CA632 17969</span></span>
<span><span class="co">## 13 1403418      CA632 17969</span></span>
<span><span class="co">## 15 1403432      CA632 17969</span></span>
<span><span class="co">## 19 1403439      CA632 17969</span></span>
<span><span class="co">## 30 1540892      CA632 17969</span></span>
<span><span class="co">## 31 1605509      CA632 17969</span></span>
<span><span class="co">##                                                          muname    cokey</span></span>
<span><span class="co">## 8                   Archerdale clay loam, 0 to 2 percent slopes 27449768</span></span>
<span><span class="co">## 13 Hicksville loam, 0 to 2 percent slopes, occasionally flooded 27449813</span></span>
<span><span class="co">## 15            Redding gravelly loam, 0 to 8 percent slopes, dry 27449968</span></span>
<span><span class="co">## 19              Peters-Pentz association, 2 to 8 percent slopes 27450031</span></span>
<span><span class="co">## 30                     Mckeonhills clay, 5 to 15 percent slopes 27450072</span></span>
<span><span class="co">## 31             Pentz-Peters association, 2 to 50 percent slopes 27450044</span></span>
<span><span class="co">##    coecoclasskey comppct_r majcompflag    compname      localphase compkind</span></span>
<span><span class="co">## 8       12784144        85         Yes  Archerdale       clay loam   Series</span></span>
<span><span class="co">## 13      12784163        85         Yes  Hicksville            loam   Series</span></span>
<span><span class="co">## 15      12784219        85         Yes     Redding   gravelly loam   Series</span></span>
<span><span class="co">## 19      12784259        60         Yes      Peters silty clay loam   Series</span></span>
<span><span class="co">## 30      12784278        90         Yes Mckeonhills            clay   Series</span></span>
<span><span class="co">## 31      12784267        62         Yes       Pentz       silt loam   Series</span></span>
<span><span class="co">##     ecoclassid                    ecoclassname    ecoclasstypename</span></span>
<span><span class="co">## 8  R017XY903CA Stream Channels and Floodplains NRCS Rangeland Site</span></span>
<span><span class="co">## 13 R017XY905CA  Dry Alluvial Fans and Terraces NRCS Rangeland Site</span></span>
<span><span class="co">## 15 R017XY902CA            Duripan Vernal Pools NRCS Rangeland Site</span></span>
<span><span class="co">## 19 R018XI164CA         Clayey Dissected Swales NRCS Rangeland Site</span></span>
<span><span class="co">## 30 R018XI163CA       Thermic Low Rolling Hills NRCS Rangeland Site</span></span>
<span><span class="co">## 31 R018XI163CA       Thermic Low Rolling Hills NRCS Rangeland Site</span></span>
<span><span class="co">##                             ecoclassref</span></span>
<span><span class="co">## 8  Ecological Site Description Database</span></span>
<span><span class="co">## 13 Ecological Site Description Database</span></span>
<span><span class="co">## 15 Ecological Site Description Database</span></span>
<span><span class="co">## 19 Ecological Site Description Database</span></span>
<span><span class="co">## 30 Ecological Site Description Database</span></span>
<span><span class="co">## 31 Ecological Site Description Database</span></span></code></pre>
<p>Note that this output includes information for the dominant component
(<code>comppct_r</code> and <code>compname</code>).</p>
</div>
<div class="section level3">
<h3 id="using-methoddominant-condition">Using <code>method="dominant condition"</code><a class="anchor" aria-label="anchor" href="#using-methoddominant-condition"></a>
</h3>
<p>The method <code>"dominant condition"</code> is convenient because it
accounts for the possibility that multiple components have the same
class (ecological site) and can have their component percentages
summed.</p>
<p>For a property like ecological site, it is fairly common for multiple
components in a map unit to have the same site assigned, so the dominant
condition makes up a higher percentage of the area of the map unit than
the dominant component alone.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eco_data_domcond</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_SDA_coecoclass.html">get_SDA_coecoclass</a></span><span class="op">(</span></span>
<span>  mukeys <span class="op">=</span> <span class="va">mukeys</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"dominant condition"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">eco_data_domcond</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mukey areasymbol  lkey</span></span>
<span><span class="co">## 8  1403409      CA632 17969</span></span>
<span><span class="co">## 13 1403418      CA632 17969</span></span>
<span><span class="co">## 15 1403432      CA632 17969</span></span>
<span><span class="co">## 19 1403439      CA632 17969</span></span>
<span><span class="co">## 30 1540892      CA632 17969</span></span>
<span><span class="co">## 31 1605509      CA632 17969</span></span>
<span><span class="co">##                                                          muname    cokey</span></span>
<span><span class="co">## 8                   Archerdale clay loam, 0 to 2 percent slopes 27449768</span></span>
<span><span class="co">## 13 Hicksville loam, 0 to 2 percent slopes, occasionally flooded 27449813</span></span>
<span><span class="co">## 15            Redding gravelly loam, 0 to 8 percent slopes, dry 27449968</span></span>
<span><span class="co">## 19              Peters-Pentz association, 2 to 8 percent slopes 27450031</span></span>
<span><span class="co">## 30                     Mckeonhills clay, 5 to 15 percent slopes 27450072</span></span>
<span><span class="co">## 31             Pentz-Peters association, 2 to 50 percent slopes 27450044</span></span>
<span><span class="co">##    coecoclasskey comppct_r majcompflag    compname      localphase compkind</span></span>
<span><span class="co">## 8       12784144        85         Yes  Archerdale       clay loam   Series</span></span>
<span><span class="co">## 13      12784163        85         Yes  Hicksville            loam   Series</span></span>
<span><span class="co">## 15      12784219        85         Yes     Redding   gravelly loam   Series</span></span>
<span><span class="co">## 19      12784259        60         Yes      Peters silty clay loam   Series</span></span>
<span><span class="co">## 30      12784278        90         Yes Mckeonhills            clay   Series</span></span>
<span><span class="co">## 31      12784267        62         Yes       Pentz       silt loam   Series</span></span>
<span><span class="co">##     ecoclassid                    ecoclassname    ecoclasstypename</span></span>
<span><span class="co">## 8  R017XY903CA Stream Channels and Floodplains NRCS Rangeland Site</span></span>
<span><span class="co">## 13 R017XY905CA  Dry Alluvial Fans and Terraces NRCS Rangeland Site</span></span>
<span><span class="co">## 15 R017XY902CA            Duripan Vernal Pools NRCS Rangeland Site</span></span>
<span><span class="co">## 19 R018XI164CA         Clayey Dissected Swales NRCS Rangeland Site</span></span>
<span><span class="co">## 30 R018XI163CA       Thermic Low Rolling Hills NRCS Rangeland Site</span></span>
<span><span class="co">## 31 R018XI163CA       Thermic Low Rolling Hills NRCS Rangeland Site</span></span>
<span><span class="co">##                             ecoclassref ecoclasspct_r</span></span>
<span><span class="co">## 8  Ecological Site Description Database            85</span></span>
<span><span class="co">## 13 Ecological Site Description Database            85</span></span>
<span><span class="co">## 15 Ecological Site Description Database            85</span></span>
<span><span class="co">## 19 Ecological Site Description Database            60</span></span>
<span><span class="co">## 30 Ecological Site Description Database            92</span></span>
<span><span class="co">## 31 Ecological Site Description Database            67</span></span></code></pre>
<p>Note that this result includes the aggregate ecological site
composition <code>ecoclasspct_r</code>.</p>
<p>The <code>cokey</code> and <code>comppct_r</code> are from the
dominant component can be used to link to a specific, common component
for other more detailed information.</p>
</div>
</div>
<div class="section level2">
<h2 id="join-tabular-and-spatial-data">Join Tabular and Spatial Data<a class="anchor" aria-label="anchor" href="#join-tabular-and-spatial-data"></a>
</h2>
<p>We want to have a 1:1 relationship between our map unit polygons and
the thematic variable we are mapping, so we will use the map unit
dominant condition ecological sites (<code>eco_data_domcond</code>).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">soil_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span></span>
<span>  <span class="va">soil_polygons</span>, </span>
<span>  <span class="va">eco_data_domcond</span>, </span>
<span>  by <span class="op">=</span> <span class="st">"mukey"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualize-the-result">Visualize the Result<a class="anchor" aria-label="anchor" href="#visualize-the-result"></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">soil_polygons</span><span class="op">[</span><span class="st">"ecoclassid"</span><span class="op">]</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Dominant Ecological Site by Map Unit"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="dominant-es_files/figure-html/plot-1.png" class="r-plt" width="672"></p>
<p>This same process for merging in aggregate map unit level information
generalizes to other SSURGO tables. You can easily create thematic maps
from any data you can aggregate to the point that it is 1:1 with the
<code>mukey</code>.</p>
</div>
<div class="section level2">
<h2 id="export-spatial-file">Export Spatial File<a class="anchor" aria-label="anchor" href="#export-spatial-file"></a>
</h2>
<p>Finally, we can write our result out to a spatial file, such as a
GeoPackage, using <code>sf</code> or <code>terra</code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_write.html" class="external-link">st_write</a></span><span class="op">(</span></span>
<span>  <span class="va">soil_polygons</span>, </span>
<span>  <span class="st">"ecosite_dominant.gpkg"</span>, </span>
<span>  delete_dsn <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div class="section level3">
<h3 id="ssurgo-data-and-tools">SSURGO Data and Tools<a class="anchor" aria-label="anchor" href="#ssurgo-data-and-tools"></a>
</h3>
<ul>
<li><a href="https://www.nrcs.usda.gov/resources/data-and-reports/ssurgo-portal" class="external-link">SSURGOPortal</a></li>
<li><a href="https://websoilsurvey.nrcs.usda.gov/app/" class="external-link">Web Soil
Survey</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="soildb-functions">soilDB functions<a class="anchor" aria-label="anchor" href="#soildb-functions"></a>
</h3>
<ul>
<li><a href="https://ncss-tech.github.io/soilDB/reference/SDA_spatialQuery.html" class="external-link"><code>SDA_spatialQuery()</code>
documentation</a></li>
<li><a href="https://ncss-tech.github.io/soilDB/reference/fetchSDA_spatial.html" class="external-link"><code>fetchSDA_spatial()</code>
documentation</a></li>
<li><a href="https://ncss-tech.github.io/soilDB/reference/get_SDA_coecoclass.html" class="external-link"><code>get_SDA_coecoclass()</code>
documentation</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="spatial-analysis-in-r">Spatial Analysis in R<a class="anchor" aria-label="anchor" href="#spatial-analysis-in-r"></a>
</h3>
<ul>
<li><a href="https://r-spatial.github.io/sf/" class="external-link"><code>sf</code> package
documentation</a></li>
<li><a href="https://rspatial.github.io/terra/" class="external-link"><code>terra</code>
package documentation</a></li>
<li><a href="https://r.geocompx.org/" class="external-link"><em>Geocomputation with R</em>
book</a></li>
<li>
<a href="https://rspatial.org/" class="external-link"><em>Spatial Data Science with R and
<code>terra</code></em> book</a>.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dylan Beaudette, Jay Skovlin, Stephen Roecker, Andrew Brown.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
